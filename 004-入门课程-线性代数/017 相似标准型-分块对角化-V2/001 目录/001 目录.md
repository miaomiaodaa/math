**引子**  
question1:找出相似关系下的全系不变量，就是找出全部的必要条件，把全部必要条件加起来就能得到充分条件，继而形成充要条件  
7.1-7.3节行列式因子，不变因子，7.5节初等因子  
  
question2: 然后利用这些充要条件构造相似标准型，即相似这个等价关系下的代表元：对角阵、约当标准型、有理标准型、 $\cdots$  
7.4节有理标准型，7.6节约当标准型  
(其实只有一类：分块对角阵，分块纯量阵、约当标准型、有理标准型)  
  
不变因子与有理标准型，初等因子组与约当标准型  
  
应用：7.7，7.8节  
  
**等价关系与划分(与商集)**  
感觉把丘版的可以放到这里(实际放在了不变子空间后面)  
老谢在这里插入(简单介绍)的等价关系，等价类，代表元，集合的划分，分类问题是代数学中的重要问题，当给出一个公理化系统或者给出一类代数对象的时候，通常会给出等价关系，应用等价关系去研究这类对象，并且给出它的分类  
等价类的优势，把整个集合分成互不相交的并集(大概率是无限个)  
相似关系是一种等价关系  
question1:寻找是判定属于哪个等价类的判定定理  
给出属于某个等价类的判定准则  
question2: 寻找代表元  
每个等价类给出一个代表元  
  
举例1： $V=M_n(K)$ 按秩划分出 $n+1$ 个等价类  
  
**多项式矩阵**  
定义1： $\lambda-$ 阵， $A(\lambda)=\lgroup a_{ij}(\lambda)\rgroup_{m\times n}$  
数字矩阵、多项式矩阵、偏导数矩阵  
  
**多项式矩阵基础运算**  
定义1： $\lambda-$ 阵相等  
(依赖多项式相等的定义)  
定义2： $\lambda-$ 阵加法、  
定义3： $\lambda-$ 阵减法、  
定义4： $\lambda-$ 阵数乘  
  
**多项式矩阵乘法**  
定义1： $\lambda-$ 阵乘法  
(依赖多项式乘法，加法的定义)  
  
**多项式矩阵的初等变换**  
定义1： $\lambda-$ 阵的初等变换  
1 交换 $A(\lambda)$ 任意两行或两列  
2 $A(\lambda)$ 某行或某列乘非零常数  
3 某行(列)乘 $f(\lambda)$ 加到另一行(列)  
(注意之前都是长方阵，这里变成方阵了)  
(第三类有区别，这样定义良在哪里)  
  
**初等多项式矩阵**  
定义1：初等 $\lambda-$ 阵  
1 $P_{ij}$ ，2 $P_i(c)$ ，3 $T_{ij}(f(\lambda))$  
注1：记号中的 $i,j$ 都是行下标，默认 $i<j$  
<font color=red>注2：对 $I_n$ 实施初等**行**变换得到的矩阵称为初等 $\lambda-$ 阵</font>  
(原来之前的认知都是错的，初等阵只有3个，不是6个)  
(依赖单位阵)  
( $\lambda$ 阵的初等变换与初等 $\lambda$ 阵的关系)  
(先有“变换”，后有“初等”)  
  
**初等变换与矩阵乘法**  
定理1：【实施 $\lambda-$ 阵初等变换】与【乘以初等 $\lambda-$ 阵】  
实施初等行变换 $\Leftrightarrow$ 左乘对应初等 $\lambda-$ 阵  
实施初等列变换 $\Leftrightarrow$ 右乘对应初等 $\lambda-$ 阵  
(还是用丘版分块矩阵的方法理解，秒杀)  
(注意那些“伪”初等 $\lambda-$ 阵)  
  
**多项式矩阵相抵**  
定义1： $\lambda-$ 阵相抵  
(依赖 $\lambda-$ 阵的初等变换)  
命题1： $\lambda-$ 阵相抵关系是一种等价关系  
(可以叙述主定理了，但是还没开始)  
  
**可逆多项式矩阵**  
定义1：可逆 $\lambda-$ 阵  
 $A(\lambda)B(\lambda)=B(\lambda)A(\lambda)=I_n$  
  
注1：数字矩阵的相关结论不能直接应用于 $\lambda-$ 阵  
  
命题1：若干可逆 $\lambda-$ 阵的乘积仍是可逆 $\lambda-$ 阵  
  
命题2：三类初等 $\lambda-$ 阵都是可逆的，且  
 $P_{ij}^{-1}=P_{ij}$ ， $P_i(c)^{-1}=P_i(1/c)$ ， $T_{ij}[f(\lambda)]^{-1}=T_{ij}[-f(\lambda)]$  
  
推论1：若干初等 $\lambda-$ 阵的乘积仍是可逆的  
  
命题3： $\lambda-$ 阵可逆 $\iff|\lambda|=$ 非零常数  
  
**矩阵多项式**  
(第二个角度看 $\lambda$ 阵)  
定义1：矩阵多项式-以矩阵为系数的多项式  
以 $\lambda$ 为未定元，以矩阵为系数的多项式  
(系数矩阵必须是同型的，不然没法加)  
  
**矩阵多项式的次数**  
定义1：矩阵多项式的次数  
  
**矩阵多项式基础运算**  
定义1：矩阵多项式相等  
(依赖矩阵相等)  
(矩阵多项式相等 $\Leftrightarrow\lambda-$ 阵相等)  
  
定义2：矩阵多项式的加法、  
定义3： 矩阵多项式的减法、  
定义4： 矩阵多项式的数乘  
  
命题1： $\rm{deg}[M(\lambda)\pm N(\lambda)]\leq\max\\{\rm{deg}M(\lambda),\rm{deg}N(\lambda)\\}$  
  
**矩阵多项式乘法**  
定义1：矩阵多项式的乘法  
(依赖矩阵乘法定义)  
(两个多项式的系数矩阵必然不能是同型的，不然没法乘)  
注：不支持交换律  
  
命题1： $\rm{deg}[M(\lambda)N(\lambda)]\leq\rm{deg}M(\lambda)+\rm{deg}N(\lambda)$ ，等号成立，当且仅当 $M(\lambda)$ 或 $N(\lambda)$ 可逆  
  
命题2：矩阵多项式的带余除法  
 $M(\lambda)=(\lambda I_n-B_n)\cdot Q(\lambda)+R$ ，其中 $R$ 是数值型矩阵  
 $M(\lambda)=S(\lambda)\cdot(\lambda I_n-B_n)+T$ ，其中 $T$ 是数值型矩阵  
注：只研究除式首项系数可逆的情形，只研究除式是特征矩阵的情形(首项系数是单位阵，是可逆的)，要分左除与右除  
(咦?这不就是两个 $\lambda-$ 阵作除法吗)  
(两个数相乘，再加上一个数)  
(两个多项式相乘，再加上一个多项式)  
(两个数字矩阵相乘，再加上一个矩阵)  
(两个 $\lambda-$ 矩阵相乘，再加上一个矩阵)  
  
**主定理-数字矩阵相似与特征矩阵相抵**  
定理：数字矩阵的相似 $\Leftrightarrow$ 他们的特征矩阵相抵  
 $A\sim B\Leftrightarrow A(\lambda)\sim B(\lambda)$  
(总感觉这个证明过程仿佛开了上帝视角)  
  
---  
  
**引问-多项式矩阵最简能化到怎样程度**  
 $\lambda-$ 阵在相抵关系下，最简能化到怎样的程度  
(即 $\lambda-$ 阵的相抵标准型，法式，Smith标准型)  
  
**相抵于具有整除关系的多项式矩阵**  
引理1：非零常数多项式可以整除任何多项式  
引理2: 存在 $B(\lambda)$ ，使得 $A(\lambda)\sim B(\lambda)$ ，其中 $b_{11}(\lambda)\mid b_{ij}(\lambda)$ ， $b_{11}\neq0$  
(证明过程)  
(对最小次数归纳+多项式带余除法+第三类 $\lambda$ 阵初等变换)  
(对任意 $m\times n$ 阶矩阵都成立)  
  
**多项式矩阵的Smith标准型**  
定义1：对角 $\lambda-$ 阵  
  
定理2: $\lambda-$ 阵的相抵标准型  
 $A\lgroup\lambda\rgroup_{n}\sim\rm{diag}\\{d_1(\lambda),d_2(\lambda),\cdots,d_r(\lambda),0,\cdots,0\\}$ ，  
其中 $d_i(\lambda)$ 首一，且 $d_i(\lambda)\mid d_{i+1}(\lambda)$  
  
说明1： $\lambda-$ 阵满秩未必可逆， $\begin{bmatrix}1&0\\\ 0&\lambda\end{bmatrix}$  
  
说明2：虽然按方阵证明的，但是对应一般的长方阵结论仍成立  
 $A\lgroup\lambda\rgroup_{m\times n}\sim\begin{bmatrix}D_r&O\\\ O&O\end{bmatrix}$ ，  
其中 $D_r=\rm{diag}\\{d_1(\lambda),d_2(\lambda),\cdots,d_r(\lambda)\\}$ ，  
其中 $d_i(\lambda)$ 首一，且 $d_i(\lambda)\mid d_{i+1}(\lambda)$  
  
(首一的：最大公因式，最小公倍式，极小多项式，法式中的元素)  
(关键词：非零首一多项式且一个整除一个)  
(由证明过程无法得出『 $d_i(\lambda)$ 的个数 $r$ 与初等变换的选取无关』)  
  
定义2： $\lambda-$ 阵的法式，或相抵标准型  
(长方阵的相抵标准型-Smith标准型)  
(方阵的相抵标准型-法式)  
(特征矩阵的相抵标准型-法式)  
  
**可逆多项式矩阵判定**  
引理1： $f(\lambda)$ 是零多项式 $\Leftrightarrow f(\lambda)$ 有无穷个根  
  
命题1: $|A(\lambda)\cdot B(\lambda)|=|A(\lambda)|\cdot|B(\lambda)|$  
(证明思路： $f(\lambda)=|A(\lambda)\cdot B(\lambda)|-|A(\lambda)|\cdot|B(\lambda)|$ )  
  
定义1： $\lambda-$ 阵的伴随矩阵  
(依赖『余子式』、『代数余子式』)  
  
命题2: $A(\lambda)\cdot A(\lambda)^\star=A(\lambda)^\star\cdot A(\lambda)=|A(\lambda)|\cdot I_n$  
(矩阵与行列式都是模型，可以更换各种集合，比如雅可比行列式)  
(域上的矩阵，环上的矩阵，域上的行列式，环上的行列式)  
  
命题3：初等 $\lambda-$ 阵的行列式  
 $|P_{ij}|=1$ ， $|P_i(c)|=c$ ， $|T_{ij}[f(\lambda)]|=1$  
  
定理1： $\lambda-$ 阵可逆判定5合1  
 $(1)\ \lambda-$ 阵可逆  
 $(2)\ |A(\lambda)|$ 是非零常数  
 $(3)\ A(\lambda)\sim I_n$  
 $(4)\ A(\lambda)$ 只经过初等行(列)变换可变成 $I_n$  
 $(5)\ A(\lambda)$ 可写成初等 $\lambda-$ 阵的乘积  
推论: $A(\lambda)^{-1}=\dfrac1{|A(\lambda)|}\cdot A(\lambda)^\star$  
(与数字矩阵可逆判定相比，没有满秩，没有特征值都不为零)  
  
**特征矩阵的相抵标准型**  
主定理:  
 $\lambda I_n-A\sim\rm{diag}\\{1,\cdots,1,d_1(\lambda),\cdots,d_m(\lambda)\\}$ ，  
其中 $d_i(\lambda)$ 非常数首一，且 $d_i(\lambda)\mid d_{i+1}(\lambda)$  
  
推论1： $\lambda I_n-A=d_1(\lambda)\cdots d_m(\lambda)$  
  
命题1：1不存在 $\Leftrightarrow A=cI_n$  
  
**计算数字矩阵的法式**  
讲了一道例题  
  
---  
  
**本节引导**  
问题： $A(\lambda)\sim B(\lambda)?\Leftrightarrow A(\lambda)$ 与 $B(\lambda)$ 有相同法式  
应用1： $\lambda-$ 阵相抵关系下的全系不变量  
应用2：法式或相抵标准型不依赖初等变换的选取  
  
**行列式因子**  
定义1：行列式因子 $D_k(\lambda)$ -所有 $k$ 阶子式的最大公因式  
(首一的：最大公因式，最小公倍式，极小多项式，法式中的元素，行列式因子)  
(注意：零也是行列式因子，不要忘了零)  
(注意：特征矩阵的 $D_n(\lambda)=$ 特征多项式 $f(\lambda)=|\lambda I_n-A|$ )  
  
命题1：法式的行列式因子  
 $D_1(\lambda)=d_1(\lambda)$ ， $D_2(\lambda)=d_1(\lambda)d_2(\lambda)$ ， $\cdots$  
 $D_r(\lambda)=d_1(\lambda)d_2(\lambda)\cdots d_r(\lambda)$  
 $D_{r+1}(\lambda)=\cdots=D_n(\lambda)=0$  
  
定理1：行列式因子的整除关系  
行列式因子满足 $D_i(\lambda)\mid D_{i+1}(\lambda)$  
(证明关键: $i+1$ 阶子式，按某行或某列展开，再用定义)  
  
**不变因子**  
定义1：不变因子  
 $g_1(\lambda)=D_1(\lambda)$ ， $g_i(\lambda)=\dfrac{D_i(\lambda)}{D_{i-1}(\lambda)}$ ， $g_r(\lambda)=\dfrac{D_r(\lambda)}{D_{r-1}(\lambda)}$  
(由行列式因子整除性知，这样的定义是良定义的)  
(别被符号迷失掉， $D_k(\lambda)$ 与 $g_k(\lambda)$ 都是多项式)  
(**首一的**：最大公因式，最小公倍式，标准因式分解，特征多项式，极小多项式，法式中的元素，行列式因子，不变因子)  
(行列式因子包含零，不变因子不包含零)  
  
命题1：法式的不变因子  
<font color=green>法式的不变因子为主对角线上非零元素</font>(**关键辅助**)  
 $g_1(\lambda)=D_1(\lambda)=d_1(\lambda)$  
 $g_2(\lambda)=\dfrac{D_2(\lambda)}{D_1(\lambda)}=d_2(\lambda)$  
 $\cdots$  
 $g_r(\lambda)=\dfrac{D_r(\lambda)}{D_{r-1}(\lambda)}=d_r(\lambda)$  
  
**多项式矩阵相抵关系的全系不变量**  
命题1：相抵的 $\lambda-$ 阵具有相同的行列式因子(**必要性**)  
推论1：相抵的 $\lambda-$ 阵具有相同的不变因子  
推论2： $A(\lambda)$ 与 $A(\lambda)$ 的法式有相同的行列式因子  
推论3： $A(\lambda)$ 与 $A(\lambda)$ 的法式有相同的不变因子  
推论4：法式相抵 $\Leftrightarrow$ 相同的行列式因子  
推论5：法式相抵 $\Leftrightarrow$ 相同的不变因子  
推论6：法式相等 $\Leftrightarrow$ 相同的行列式因子  
推论7：法式相等 $\Leftrightarrow$ 相同的不变因子  
推论8：<font color=blue>法式相抵 $\Leftrightarrow$ 相同的行列式因子 $\Leftrightarrow$ 法式相等</font>  
推论9：<font color=blue>法式相抵 $\Leftrightarrow$ 相同的不变因子 $\Leftrightarrow$ 法式相等</font>  
(**由[必要]到[充分]的转折点**)  
  
定理1： $A(\lambda)$ 的不变因子是 $A(\lambda)$ 的法式主对角线上非零元素  
推论1： $A(\lambda)$ 的法式与不变因子可以互相唯一确定  
  
**主理**：<font color=red> $A(\lambda)\sim B(\lambda)\Leftrightarrow A$ 的法式 $=B$ 的法式</font>  
(回答了本节课开始的问题)  
  
推论1： 行列式因子、不变因子是 $\lambda-$ 阵相抵关系下的全系不变量  
 $A(\lambda)\sim B(\lambda)\Leftrightarrow A$ 的不变因子 $=B$ 的不变因子  
 $A(\lambda)\sim B(\lambda)\Leftrightarrow A$ 的行列式因子 $=B$ 的行列式因子  
(本节课开始的应用1)  
  
推论2： 法式(相抵标准型)不依赖初等变换的选取  
 $A\sim\Lambda_1$ ， $A\sim\Lambda_2$  
(本节课开始的应用2)，(证明了 $r$ 确实是秩)  
  
推论3：不变因子组在基域扩张下不改变  
(总觉着别扭，但又说不上来)  
  
**数字矩阵相似关系下的全系不变量**  
定理1： $A\sim B\Leftrightarrow\lambda I_n-A$ 与 $\lambda I_n-B$ 有相同的行列式因子  
推论1： $A\sim B\Leftrightarrow\lambda I_n-A$ 与 $\lambda I_n-B$ 有相同的不变因子  
注：以后称为矩阵 $A$ 的行列式因子，不变因子  
(**构造相似标准型的核心依据**)  
  
**补充-相似关系在域扩张下不变**  
定理：设 $A,B\in M_n(F)$ ， $F\subseteq K$ ， $A|_F\sim B|_F\Leftrightarrow A|_K\sim B|_K$  
(本节课内容结束，但有剩余时间)  
  
---  
  
**友阵**  
定义1：友阵(数字矩阵)  
定义2：友阵的特征矩阵( $\lambda-$ 阵)  
定义3：友阵的特征多项式( $f(\lambda)\in K[\lambda]$ )  
(首一多项式 $\to$ 友阵 $\to$ 友阵的特征多项式、极小多项式)  
(助记：右上角是 $r-1$ 阶单位阵)  
  
命题1：友阵的特征多项式  
 $f(\lambda)=\lambda^r+a_1\lambda^{r-1}+\cdots+a_{r-1}\lambda+a_r$  
  
命题2：友阵的极小多项式  
 $m(\lambda)=\lambda^r+a_1\lambda^{r-1}+\cdots+a_{r-1}\lambda+a_r$  
  
命题3：友阵的行列式因子， $\underbrace{1,\cdots,1}_{r-1个},f(\lambda)$  
  
命题4：友阵的不变因子， $\underbrace{1,\cdots,1}_{r-1个},f(\lambda)$  
(注：命题1-4是引理1一拆四)  
  
**根据不变因子组构造有理标准型**  
引理2：  
 $A(\lambda)\sim\rm{diag}\\{d_1(\lambda),d_2(\lambda),\cdots,d_n(\lambda)\\}$  
 $B(\lambda)\sim\rm{diag}\\{d_{i_1}(\lambda),d_{i_2}(\lambda),\cdots,d_{i_n}(\lambda)\\}$  
则 $A(\lambda)\sim B(\lambda)$  
(其实就是调整法式主对角线上元素的次序，得到的 $\lambda-$ 阵与原法式仍然相抵)  
  
主定理: $A\sim\rm{diag}\\{F(d_1(\lambda)),F(d_2(\lambda)),\cdots,F(d_k(\lambda))\\}$  
其中 $d_1(\lambda),\ d_2(\lambda),\ \cdots,\ d_k(\lambda)$ 是 $A$ 的非尝试不变因子  
  
推论1： $|\lambda I_n-A|=d_1(\lambda)d_2(\lambda)\cdots d_k(\lambda)$  
全体不变因子的乘积是特征多项式  
(由证明过程可得：特征多项式 $=$ 不变因子的乘积)  
(桥梁是行列式因子)  
  
定义1：Frobenius标准型，有理标准型  
定义2：Frobenius块，有理块  
  
例题：已知不变因子组求Frobenius标准型  
(不变因子(首一多项式) $\leftrightharpoons$ Frobenius块(友阵))  
(对应法则：**取相反数 $+$ 反转**)  
  
定理2: 次数最高的不变因子是极小多项式， $m(\lambda)=d_k(\lambda)$  
(相似矩阵具有相同的极小多项式)  
(分块对角阵的极小多项式)  
(友阵的极小多项式)  
  
命题1: 极小多项式在基域扩张下不变  
(初等因子组在基域扩张下不变)  
  
---  
  
**准素因子**  
定义1：准素因子  
设 $p(x)$ 是既约多项式， $p(x)^{k}\mid f(x)$ ， $p(x)^{k+1}\nmid f(x)$ ，则 $p(x)^k$ 称为 $f(x)$ 的准素因子  
(类比杜版重因式的定义)，( $k$ 重因式)  
  
**初等因子**  
定义1：对 $d_1(\lambda),d_2(\lambda),\cdots d_k(\lambda)$ 进行公共标准因式分解， 全部准素因子构成的一个集合称为不变因子组  
(**大概率是有重复的**)  
(不变因子组包含常数，初等因子组不包含常数)  
  
**不变因子与初等因子的一一对应**  
引理1：不变因子与初等因子是一一对应的  
(给定一组不变因子，有且只有唯一的一组初等因子与之对应)  
(给定一组初等因子，有且只有唯一的一组不变因子与之对应)  
(横着排，竖着排都行，无所谓)  
 $\begin{array}{c}P_1(\lambda)^{e_{k1}}&P_1(\lambda)^{e_{k-11}}&\cdots&P_1(\lambda)^{e_{11}}\\\  
P_2(\lambda)^{e_{k2}}&P_2(\lambda)^{e_{k-12}}&\cdots&P_2(\lambda)^{e_{12}}\\\  
\vdots&\vdots&\vdots&\vdots\\\  
\underset{d_k(\lambda)}{\underline{P_t(\lambda)^{e_{kt}}}}&P_t(\lambda)^{e_{k-1t}}&\cdots&P_t(\lambda)^{e_{1t}}\end{array}$  
  
**初等因子组是相似关系下的全系不变量**  
定理1： $A\sim B\Leftrightarrow A$ 与 $B$ 有相同的初等因子  
即初等因子组是相似关系下的全系不变量  
  
命题1：初等因子依赖基域的选取  
(不同域下有不同的初等因子)  
(谢版以例题方式给出)  
  
命题2：全体初等因子的乘积 $=$ 特征多项式  
  
例题：例1在不同域上求初等因子，例2已知不变因子求初等因子  
  
---  
  
**由初等因子构造约当标准型-构造思路**  
使得矩阵的非常数不变因子只有一个，即 $d_i(\lambda)$  
使得矩阵的初等因子只有一个，即 $P_i(\lambda)^{e_i}$  
怎样才能只有一个呢，其他的不变因子或初等因子都是1，怎样其他才能都是1呢，上次对角线都是1，这样就理解为啥约当块与有理块上次对角线上都是1了  
其实是强循环子空间  
  
**由初等因子构造约当标准型**  
定义1：约当块 $J_r(\lambda_0)$  
定义2：约当标准型  
  
引理1：约当块 $J_r(\lambda_0)$ 的初等因子为 $(\lambda-\lambda_0)^r$  
(全程使用定义证明：数字矩阵 $J\to$ 特征矩阵 $\lambda I-J\to$ 特征矩阵的行列式因子 $\to$ 不变因子)  
  
(从证明过程可得)  
命题1：约当块的行列式因子  
命题2：约当块的不变因子  
命题3：约当块的初等因子  
命题4：约当块的特征多项式  
命题5：约当块的极小多项式( $f(\lambda),m(\lambda),d_k(\lambda)$ )  
命题6：约当块的法式  
  
引理2：对角 $\lambda-$ 阵的初等因子  
特征矩阵化成相抵的对角阵，对该对角阵上主对角线元素进行因式分解，所得的准素因子就是 $A$ 的初等因子  
(求初等因子的另一种方法)  
  
引理3：约当标准型的初等因子组  
 $\rm{J}=\rm{diag}\\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_k}(\lambda_k)\\}$  
则 $\rm{J}$ 的初等因子组为 $(\lambda-\lambda_1)^{r_1}, (\lambda-\lambda_2)^{r_2}, \cdots, (\lambda-\lambda_k)^{r_k}$  
  
主定理-代数版: $A\sim A$ 的约当标准型  
( $A\to A$ 的特征矩阵 $\to A$ 的初等因子 $\to A$ 的约当标准型)  
  
主定理-几何版: 存在一个基，使得线性变换 $\Phi$ 在该基下的表示阵为约当标准型  
  
推广：设 $A\in M_n(K)$ , $A$ 的全部特征值 $\in K$ ，  
则存在可逆阵 $P\in M_n(K)$ ，使得 $A$ 相似于 $\rm{J}=\rm{diag}\\{J_{r_1}(\lambda_1),J_{r_2}(\lambda_2),\cdots,J_{r_k}(\lambda_k)\\}$  
  
**可对角化判定-6**  
定理： $A$ 可对角化 $\Leftrightarrow A$ 的初等因子都是一次多项式  
(注：此处才给出了『可对角化判定-5』的充分性证明)  
  
**极小多项式无重根的应用(易被忽视的内容)**  
<font color=red>命题1：若 $\Phi$ 可对角化，则 $\Phi\vert_{V_0}$ 也可对角化  
(若 $\Phi$ 可对角化，则 $\Phi$ 限制在任意不变子空间下都可对角化)  
  
命题2：若 $M=\begin{bmatrix}A&C\\\ O&B\end{bmatrix}$ 可对角化，则 $A,B$ 均可对角化  
(命题1的代数版本)  
  
命题3：设 $\Phi\in\mathbb{L}(V_{\mathbb{C}}^n)$ ， $V_1,V_2,\cdots,V_k$ 是 $\Phi$ 不变子空间，且 $V=V_1\oplus V_2\oplus\cdots\oplus V_k$  
 $\Phi$ 可对角化 $\Leftrightarrow\Phi\mid_{V_i}$ 可对角化， $1\le i\le k$  
  
命题4：设 $A=\begin{bmatrix}  
A_1&&\\\ &A_2&\\\ &&\ddots\\\ &&&A_k  
\end{bmatrix}$ ， $A$ 可对角化，当且仅当 $A_1,\ A_2,\ \cdots, A_k$ 均可对角化  
(命题3的代数版本)  
</font>  
  
**例题讲解-根据初等因子组写出约当标准型**  
例1：根据初等因子组写出约当标准型  
  
**例题讲解-计算约当标准型的过渡矩阵**  
例2：计算约当标准型的过渡矩阵  
(初等 $\lambda-$ 阵变换 $\to$ 法式 $\to$ 不变因子 $\to$ 初等因子)  
(行列式因子 $\to$ 不变因子 $\to$ 初等因子)  
(进一步讨论在『专题1』)  
设 $P=(\alpha_1,\alpha_2,\alpha_3,\alpha_4)$  
 $\Rightarrow A(\alpha_1,\alpha_2,\alpha_3,\alpha_4)=(\alpha_1,\alpha_2,\alpha_3,\alpha_4)\cdot  
\begin{bmatrix}1&1\\\ 0&1\\\ &&1&1\\\ &&0&1\end{bmatrix}$  
  
 $\Rightarrow\begin{array}\Rightarrow\begin{cases}  
A\alpha_1=\alpha_1&\\\  
A\alpha_2=\alpha_1+\alpha_2&\\\  
A\alpha_3=\alpha_3&\\\  
A\alpha_4=\alpha_3+\alpha_4  
\end{cases}&\Rightarrow\begin{cases}  
A\alpha_1=\alpha_1&\\\  
(A-I_4)\alpha_2=\alpha_1&\\\  
A\alpha_3=\alpha_3&\\\  
(A-I_4)\alpha_4=\alpha_3  
\end{cases}\end{array}$  
  
---  
  
**约当标准型应用-空间的直和分解**  
(**配合『不变子空间』部分 $+$ 『丘版路线』食用，效果更好**)  
(恒等变换，纯量变换，投影变换，幂零变换，循环映射)  
1 全空间可以分解成不变子空间的直和  
2 代数重数 $=$ 约当块阶数的和  
3 几何重数 $=$ 约当块个数(特征子空间的维数)  
4 特征子空间的一个基  
5 $\Phi_{V_i}=$ 循环变换 $+$ 纯量变换  
 $\enspace\Phi_{V_i}=$ 幂零变换 $+$ 纯量变换  
 $\enspace\Phi_{V_i}$ 不变子空间 $=\Psi$ 循环子空间  
(<font color=red>同一子空间，即是 $\Phi$ 的不变子空间，又是 $\Psi$ 的循环子空间</font>)  
(全空间可以写成**另外一个**线性变换的循环子空间的直和)  
6 根子空间  
定义1：根子空间  
(代数意义：所有特征值相同的约当块凑在一起)  
命题1：根子空间等价定义  
定义2：根子空间等价定义  
定理1： $\Phi$ 可对角化 $\Leftrightarrow\Phi$ 的根子空间 $=$ 特征子空间  
(特征值 $\lambda_0$ 的 $\Phi$ 不变子空间 $V_i$ )  
(特征值 $\lambda_0$ 的特征子空间 $V_{\lambda_0}$ )  
(特征值 $\lambda_0$ 的根子空间 $R(\lambda_0)$ )  
(<font color=red>研究线性空间的四条途径</font>)  
(途径1 生成子空间，基)  
(途径2 利用子空间的运算，直和子空间)  
(途径3 线性同构，同构)  
(途径4 商集)  
不变子空间的直和  
循环子空间的直和  
根子空间的直和  
  
**约当标准型应用-矩阵分解**  
思路：约当块成立 $\to$ 约当标准型成立 $\to$ 一般矩阵成立  
  
命题1：任意 $n$ 阶复矩阵都能分解成两个对称矩阵的乘积  
设 $A\in M_n(\mathbf{C})$ ，则存在 $B,C$ 是对称矩阵，使得 $A=B\cdot C$  
  
场景1：求矩阵 $A$ 的高次幂  
  
 $\rm{JC}$ 分解  
定义1：可同时对角化-代数版  
设 $A,B\in M_n(K)$ ，若存在非异阵 $P$ ，使得 $P^{-1}AP$ 与 $P^{-1}BP$ 是对角阵，则称 $A,B$ 可同时对角化  
  
定义2：可同时对角化-几何版  
设 $\Phi,\Psi\in\mathbb{L}(V_K)$ ，若 $\Phi,\Psi$ 存在一个公共基，使得 $\Phi,\Psi$ 在该基下的表示阵为对角阵，则称 $\Phi,\Psi$ 可同时对角化  
  
引理1：联动各种不变子空间  
  
引理2：设 $A,B\in M_n(K)$ ，若 $A,B$ 均可对角化，且 $AB=BA$ ，则 $A,B$ 可同时对角化  
  
引理3：设 $\Phi,\Psi\in\mathbb{L}(V_K)$ ，若 $\Phi,\Psi$ 均可对角化，且 $\Phi\circ\Psi=\Psi\circ\Phi$ ，则 $\Phi,\Psi$ 可同时对角化  
(用于主定理的唯一性证明)  
(一刷没懂，二刷懵逼，三刷懂了，四刷又懵逼了)  
  
主定理: 设 $A,B,C\in M_n(K)$ ，则 $A=B+C$ ，其中  
 $1^\circ\ B$ 可对角化，  
 $2^\circ\ C$ 是幂零阵，  
 $3^\circ\ B\cdot C=C\cdot B$ ，  
 $4^\circ\ \exists\ f(x)\in K[x]$ ，使得 $B=f(A),C=g(A)$ ，  
进一步，若分解出的矩阵 $B,C$ 满足前三个条件，则这样的 $B,C$ 是唯一的  
注1：在李代数里才能发挥出作用，线代里没有体现  
注2： $\rm{JC}$ 分解还有一个乘法版本  
思路：根子空间块成立 $\to$ 约当标准型成立 $\to$ 一般矩阵成立  
  
---  
  
**约当标准型小专题**  
(本章正课结束，开始小专题)  
 $\rm{Topic1}$ ：求过渡矩阵 $P$ 的进一步讨论，即如何合理选取特征向量，求出广义特征向量  
答：**应该取基础解系的线性组合带入广义特征向量的方程**，利用系数矩阵的秩=增广矩阵的秩，求出待定系数  
(若不足以求出待定系数，那再找怎样的等式呢？)  
(谢版说本Topic与常微分方程有联动)  
  
 $\rm{Topic2}$ ：含参数数字矩阵求约当标准型  
1 选取特殊子式，求行列式因子  
2 特征值几何重数，确定约当块的个数  
3 计算极小多项式，确定最大约当块的阶数  
(讲了2个例题，例题1：一题三解，例题2：综合法)  
(这两个例题的共性是都只有一个特征值)  
(貌似这些题里都包含了夹逼的思想)  
(像空间的维数与表示矩阵的秩，这部分内容类似逻辑推理)  
(脑筋急转弯😂😂)  
  
 $\rm{Topic3}$ ：循环子空间，空间分解的进一步讨论  
<font color=blue>定义1</font>: 设 $\Phi\in\mathbf{L}(V_K^n)$ ， $0\neq\alpha$ ，由向量族 $S=(\alpha,\Phi(\alpha),\Phi^2(\alpha),\cdots)\subset V_K^n$ 张成的空间，称为 $\Phi$ 的关于循环向量 $\alpha$ 的循环子空间，记作 $C(\Phi,\alpha)$  
  
我的理解：  
 $\begin{array}{l}\varphi\to\varphi^k=零线性变换\leftarrow幂零变换\\\ \downarrow\\\ S=(\alpha,\Phi(\alpha),\Phi^2(\alpha),\cdots,\Phi^k(\alpha))向量组\\\ \downarrow\\\ 由向量组S生成的子空间\mathbf{L}(S)：强循环子空间\\\ \downarrow\\\ 强循环子空间\mathbf{L}(S)的表示矩阵：幂零阵\end{array}$  
  
<font color=blue>命题1</font>: 设 $\rm{dim}(C(\Phi,\alpha))=m$ ，则 $(\alpha,\Phi(\alpha),\Phi^2(\alpha),\cdots,\Phi^{m-1}(\alpha))$ 是 $C(\Phi,\alpha)$ 的一个基  
  
<font color=blue>命题2</font>: $C(\Phi,\alpha)$ 是包含 $\alpha$ 的最小 $\Phi$ 不变子空间  
  
<font color=blue>命题3</font>: 设 $\Phi^m(\alpha)=-a_0\alpha-a_1\Phi(\alpha)-\cdots-a_{m-1}\Phi^{m-1}(\alpha)$  
令 $g(x)=x^m+a_{m-1}x^{m-1}+\cdots+a_1x+a_0\in K[x]$  
 $\Phi\mid_{C(\Phi,\alpha)}$ 在基 $(\alpha,\Phi(\alpha),\Phi^2(\alpha),\cdots,\Phi^{m-1}(\alpha))$ 下的表示矩阵为 $g(x)$ 的友阵  
  
例1： $\Phi(\alpha)=\lambda_0\cdot\alpha\Rightarrow C(\Phi,\alpha)=\mathbf{L}(\alpha)$  
例2：有理标准型几何意义：全空间 $=$ 循环子空间的直和  
 $\quad\quad$ 约当标准型几何意义：全空间 $=$ 不变子空间的直和  
 $\quad\quad$ 约当标准型几何意义：全空间 $=$ 根子空间的直和  
  
命题4：[脑子不够使了TODO]  
  
